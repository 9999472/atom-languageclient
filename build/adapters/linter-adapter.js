Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = undefined;

var _languageclient = require('../languageclient');

var _convert = require('../convert');

var _convert2 = _interopRequireDefault(_convert);

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

let LinterAdapter = class LinterAdapter {

  constructor(languageClient) {
    this._diagnosticMap = new Map();

    this._lc = languageClient;
    this._lc.onPublishDiagnostics(this.captureDiagnostics.bind(this));
  }

  captureDiagnostics(params) {
    const path = _convert2.default.uriToPath(params.uri);
    this._diagnosticMap.set(params.uri, params.diagnostics.map(d => LinterAdapter.diagnosticToMessage(path, d)));
  }

  provideDiagnostics() {
    let allResults = [];
    for (let fileResults of this._diagnosticMap.values()) allResults = allResults.concat(fileResults);
    return allResults;
  }

  static diagnosticToMessage(path, diagnostic) {
    return {
      filePath: path,
      text: diagnostic.message,
      range: _convert2.default.lsRangeToAtomRange(diagnostic.range),
      name: diagnostic.source,
      code: diagnostic.code,
      severity: LinterAdapter.diagnosticSeverityToSeverity(diagnostic.severity || -1),
      type: LinterAdapter.diagnosticSeverityToType(diagnostic.severity || -1)
    };
  }

  static diagnosticSeverityToType(severity) {
    switch (severity) {
      case _languageclient.DiagnosticSeverity.Error:
        return 'Error';
      case _languageclient.DiagnosticSeverity.Warning:
        return 'Warning';
      case _languageclient.DiagnosticSeverity.Information:
        return 'Information';
      case _languageclient.DiagnosticSeverity.Hint:
        return 'Hint';
      default:
        return '';
    };
  }

  static diagnosticSeverityToSeverity(severity) {
    switch (severity) {
      case _languageclient.DiagnosticSeverity.Error:
        return 'error';
      case _languageclient.DiagnosticSeverity.Warning:
        return 'warning';
      case _languageclient.DiagnosticSeverity.Information:
      case _languageclient.DiagnosticSeverity.Hint:
      default:
        return 'info';
    }
  }
};
exports.default = LinterAdapter;
module.exports = exports['default'];
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uL2xpYi9hZGFwdGVycy9saW50ZXItYWRhcHRlci5qcyJdLCJuYW1lcyI6WyJMaW50ZXJBZGFwdGVyIiwiY29uc3RydWN0b3IiLCJsYW5ndWFnZUNsaWVudCIsIl9kaWFnbm9zdGljTWFwIiwiTWFwIiwiX2xjIiwib25QdWJsaXNoRGlhZ25vc3RpY3MiLCJjYXB0dXJlRGlhZ25vc3RpY3MiLCJiaW5kIiwicGFyYW1zIiwicGF0aCIsInVyaVRvUGF0aCIsInVyaSIsInNldCIsImRpYWdub3N0aWNzIiwibWFwIiwiZCIsImRpYWdub3N0aWNUb01lc3NhZ2UiLCJwcm92aWRlRGlhZ25vc3RpY3MiLCJhbGxSZXN1bHRzIiwiZmlsZVJlc3VsdHMiLCJ2YWx1ZXMiLCJjb25jYXQiLCJkaWFnbm9zdGljIiwiZmlsZVBhdGgiLCJ0ZXh0IiwibWVzc2FnZSIsInJhbmdlIiwibHNSYW5nZVRvQXRvbVJhbmdlIiwibmFtZSIsInNvdXJjZSIsImNvZGUiLCJzZXZlcml0eSIsImRpYWdub3N0aWNTZXZlcml0eVRvU2V2ZXJpdHkiLCJ0eXBlIiwiZGlhZ25vc3RpY1NldmVyaXR5VG9UeXBlIiwiRXJyb3IiLCJXYXJuaW5nIiwiSW5mb3JtYXRpb24iLCJIaW50Il0sIm1hcHBpbmdzIjoiOzs7OztBQUVBOztBQUVBOzs7Ozs7SUFFcUJBLGEsR0FBTixNQUFNQSxhQUFOLENBQW9COztBQUlqQ0MsY0FBWUMsY0FBWixFQUFzRDtBQUFBLFNBRnREQyxjQUVzRCxHQUZELElBQUlDLEdBQUosRUFFQzs7QUFDcEQsU0FBS0MsR0FBTCxHQUFXSCxjQUFYO0FBQ0EsU0FBS0csR0FBTCxDQUFTQyxvQkFBVCxDQUE4QixLQUFLQyxrQkFBTCxDQUF3QkMsSUFBeEIsQ0FBNkIsSUFBN0IsQ0FBOUI7QUFDRDs7QUFFREQscUJBQW1CRSxNQUFuQixFQUEyRDtBQUN6RCxVQUFNQyxPQUFPLGtCQUFRQyxTQUFSLENBQWtCRixPQUFPRyxHQUF6QixDQUFiO0FBQ0EsU0FBS1QsY0FBTCxDQUFvQlUsR0FBcEIsQ0FBd0JKLE9BQU9HLEdBQS9CLEVBQW9DSCxPQUFPSyxXQUFQLENBQW1CQyxHQUFuQixDQUF1QkMsS0FBS2hCLGNBQWNpQixtQkFBZCxDQUFrQ1AsSUFBbEMsRUFBd0NNLENBQXhDLENBQTVCLENBQXBDO0FBQ0Q7O0FBRURFLHVCQUE0QztBQUMxQyxRQUFJQyxhQUFvQyxFQUF4QztBQUNBLFNBQUssSUFBSUMsV0FBVCxJQUF3QixLQUFLakIsY0FBTCxDQUFvQmtCLE1BQXBCLEVBQXhCLEVBQ0VGLGFBQWFBLFdBQVdHLE1BQVgsQ0FBa0JGLFdBQWxCLENBQWI7QUFDRixXQUFPRCxVQUFQO0FBQ0Q7O0FBRUQsU0FBT0YsbUJBQVAsQ0FBMkJQLElBQTNCLEVBQXlDYSxVQUF6QyxFQUFpRjtBQUMvRSxXQUFPO0FBQ0xDLGdCQUFVZCxJQURMO0FBRUxlLFlBQU1GLFdBQVdHLE9BRlo7QUFHTEMsYUFBTyxrQkFBUUMsa0JBQVIsQ0FBMkJMLFdBQVdJLEtBQXRDLENBSEY7QUFJTEUsWUFBTU4sV0FBV08sTUFKWjtBQUtMQyxZQUFNUixXQUFXUSxJQUxaO0FBTUxDLGdCQUFVaEMsY0FBY2lDLDRCQUFkLENBQTJDVixXQUFXUyxRQUFYLElBQXVCLENBQUMsQ0FBbkUsQ0FOTDtBQU9MRSxZQUFNbEMsY0FBY21DLHdCQUFkLENBQXVDWixXQUFXUyxRQUFYLElBQXVCLENBQUMsQ0FBL0Q7QUFQRCxLQUFQO0FBU0Q7O0FBRUQsU0FBT0csd0JBQVAsQ0FBZ0NILFFBQWhDLEVBQTBEO0FBQ3hELFlBQU9BLFFBQVA7QUFDRSxXQUFLLG1DQUFtQkksS0FBeEI7QUFDRSxlQUFPLE9BQVA7QUFDRixXQUFLLG1DQUFtQkMsT0FBeEI7QUFDRSxlQUFPLFNBQVA7QUFDRixXQUFLLG1DQUFtQkMsV0FBeEI7QUFDRSxlQUFPLGFBQVA7QUFDRixXQUFLLG1DQUFtQkMsSUFBeEI7QUFDRSxlQUFPLE1BQVA7QUFDRjtBQUNFLGVBQU8sRUFBUDtBQVZKLEtBV0M7QUFDRjs7QUFFRCxTQUFPTiw0QkFBUCxDQUFvQ0QsUUFBcEMsRUFBb0Y7QUFDbEYsWUFBT0EsUUFBUDtBQUNFLFdBQUssbUNBQW1CSSxLQUF4QjtBQUNFLGVBQU8sT0FBUDtBQUNGLFdBQUssbUNBQW1CQyxPQUF4QjtBQUNFLGVBQU8sU0FBUDtBQUNGLFdBQUssbUNBQW1CQyxXQUF4QjtBQUNBLFdBQUssbUNBQW1CQyxJQUF4QjtBQUNBO0FBQ0UsZUFBTyxNQUFQO0FBUko7QUFVRDtBQTNEZ0MsQztrQkFBZHZDLGEiLCJmaWxlIjoibGludGVyLWFkYXB0ZXIuanMiLCJzb3VyY2VzQ29udGVudCI6WyIvLyBAZmxvd1xyXG5cclxuaW1wb3J0IHtMYW5ndWFnZUNsaWVudENvbm5lY3Rpb24sIERpYWdub3N0aWNTZXZlcml0eX0gZnJvbSAnLi4vbGFuZ3VhZ2VjbGllbnQnO1xyXG5pbXBvcnQgdHlwZSB7RGlhZ25vc3RpYywgUHVibGlzaERpYWdub3N0aWNzUGFyYW1zfSBmcm9tICcuLi9sYW5ndWFnZWNsaWVudCc7XHJcbmltcG9ydCBDb252ZXJ0IGZyb20gJy4uL2NvbnZlcnQnO1xyXG5cclxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgTGludGVyQWRhcHRlciB7XHJcbiAgX2xjOiBMYW5ndWFnZUNsaWVudENvbm5lY3Rpb247XHJcbiAgX2RpYWdub3N0aWNNYXA6IE1hcDxzdHJpbmcsIEFycmF5PGxpbnRlciRNZXNzYWdlPj4gPSBuZXcgTWFwKCk7XHJcblxyXG4gIGNvbnN0cnVjdG9yKGxhbmd1YWdlQ2xpZW50OiBMYW5ndWFnZUNsaWVudENvbm5lY3Rpb24pIHtcclxuICAgIHRoaXMuX2xjID0gbGFuZ3VhZ2VDbGllbnQ7XHJcbiAgICB0aGlzLl9sYy5vblB1Ymxpc2hEaWFnbm9zdGljcyh0aGlzLmNhcHR1cmVEaWFnbm9zdGljcy5iaW5kKHRoaXMpKTtcclxuICB9XHJcblxyXG4gIGNhcHR1cmVEaWFnbm9zdGljcyhwYXJhbXM6IFB1Ymxpc2hEaWFnbm9zdGljc1BhcmFtcyk6IHZvaWQge1xyXG4gICAgY29uc3QgcGF0aCA9IENvbnZlcnQudXJpVG9QYXRoKHBhcmFtcy51cmkpO1xyXG4gICAgdGhpcy5fZGlhZ25vc3RpY01hcC5zZXQocGFyYW1zLnVyaSwgcGFyYW1zLmRpYWdub3N0aWNzLm1hcChkID0+IExpbnRlckFkYXB0ZXIuZGlhZ25vc3RpY1RvTWVzc2FnZShwYXRoLCBkKSkpO1xyXG4gIH1cclxuXHJcbiAgcHJvdmlkZURpYWdub3N0aWNzKCk6IEFycmF5PGxpbnRlciRNZXNzYWdlPiB7XHJcbiAgICBsZXQgYWxsUmVzdWx0czogQXJyYXk8bGludGVyJE1lc3NhZ2U+ID0gW107XHJcbiAgICBmb3IgKGxldCBmaWxlUmVzdWx0cyBvZiB0aGlzLl9kaWFnbm9zdGljTWFwLnZhbHVlcygpKVxyXG4gICAgICBhbGxSZXN1bHRzID0gYWxsUmVzdWx0cy5jb25jYXQoZmlsZVJlc3VsdHMpO1xyXG4gICAgcmV0dXJuIGFsbFJlc3VsdHM7XHJcbiAgfVxyXG5cclxuICBzdGF0aWMgZGlhZ25vc3RpY1RvTWVzc2FnZShwYXRoOiBzdHJpbmcsIGRpYWdub3N0aWM6IERpYWdub3N0aWMpOiBsaW50ZXIkTWVzc2FnZSB7XHJcbiAgICByZXR1cm4ge1xyXG4gICAgICBmaWxlUGF0aDogcGF0aCxcclxuICAgICAgdGV4dDogZGlhZ25vc3RpYy5tZXNzYWdlLFxyXG4gICAgICByYW5nZTogQ29udmVydC5sc1JhbmdlVG9BdG9tUmFuZ2UoZGlhZ25vc3RpYy5yYW5nZSksXHJcbiAgICAgIG5hbWU6IGRpYWdub3N0aWMuc291cmNlLFxyXG4gICAgICBjb2RlOiBkaWFnbm9zdGljLmNvZGUsXHJcbiAgICAgIHNldmVyaXR5OiBMaW50ZXJBZGFwdGVyLmRpYWdub3N0aWNTZXZlcml0eVRvU2V2ZXJpdHkoZGlhZ25vc3RpYy5zZXZlcml0eSB8fCAtMSksXHJcbiAgICAgIHR5cGU6IExpbnRlckFkYXB0ZXIuZGlhZ25vc3RpY1NldmVyaXR5VG9UeXBlKGRpYWdub3N0aWMuc2V2ZXJpdHkgfHwgLTEpLFxyXG4gICAgfTtcclxuICB9XHJcblxyXG4gIHN0YXRpYyBkaWFnbm9zdGljU2V2ZXJpdHlUb1R5cGUoc2V2ZXJpdHk6IG51bWJlcik6IHN0cmluZyB7XHJcbiAgICBzd2l0Y2goc2V2ZXJpdHkpIHtcclxuICAgICAgY2FzZSBEaWFnbm9zdGljU2V2ZXJpdHkuRXJyb3I6XHJcbiAgICAgICAgcmV0dXJuICdFcnJvcic7XHJcbiAgICAgIGNhc2UgRGlhZ25vc3RpY1NldmVyaXR5Lldhcm5pbmc6XHJcbiAgICAgICAgcmV0dXJuICdXYXJuaW5nJztcclxuICAgICAgY2FzZSBEaWFnbm9zdGljU2V2ZXJpdHkuSW5mb3JtYXRpb246XHJcbiAgICAgICAgcmV0dXJuICdJbmZvcm1hdGlvbic7XHJcbiAgICAgIGNhc2UgRGlhZ25vc3RpY1NldmVyaXR5LkhpbnQ6XHJcbiAgICAgICAgcmV0dXJuICdIaW50JztcclxuICAgICAgZGVmYXVsdDpcclxuICAgICAgICByZXR1cm4gJyc7XHJcbiAgICB9O1xyXG4gIH1cclxuXHJcbiAgc3RhdGljIGRpYWdub3N0aWNTZXZlcml0eVRvU2V2ZXJpdHkoc2V2ZXJpdHk6IG51bWJlcik6ICdlcnJvcicgfCAnd2FybmluZycgfCAnaW5mbycge1xyXG4gICAgc3dpdGNoKHNldmVyaXR5KSB7XHJcbiAgICAgIGNhc2UgRGlhZ25vc3RpY1NldmVyaXR5LkVycm9yOlxyXG4gICAgICAgIHJldHVybiAnZXJyb3InO1xyXG4gICAgICBjYXNlIERpYWdub3N0aWNTZXZlcml0eS5XYXJuaW5nOlxyXG4gICAgICAgIHJldHVybiAnd2FybmluZyc7XHJcbiAgICAgIGNhc2UgRGlhZ25vc3RpY1NldmVyaXR5LkluZm9ybWF0aW9uOlxyXG4gICAgICBjYXNlIERpYWdub3N0aWNTZXZlcml0eS5IaW50OlxyXG4gICAgICBkZWZhdWx0OlxyXG4gICAgICAgIHJldHVybiAnaW5mbyc7XHJcbiAgICB9XHJcbiAgfVxyXG59XHJcbiJdfQ==